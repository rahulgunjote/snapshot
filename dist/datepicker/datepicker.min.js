!function(){function t(t){return t instanceof Date&&!!t.getTime&&!isNaN(t.getTime())}function e(t){return t.getUTCFullYear()}function n(t){return t.getUTCMonth()}function r(t){return t.getUTCDate()}function i(t,e){var n=t.toString(),r=new Array(e).join("0");return(r+n).substr(-e)}function o(t){return[i(e(t),4),i(n(t)+1,2),i(r(t),2)].join("-")}function a(e){if(t(e))return e;var n=f.exec(e);return n?new Date(n[1],n[2]-1,n[3]):null}function s(e){if(t(e))return e;var n=a(e);if(n)return n;var r=Date.parse(e);return isNaN(r)?null:new Date(r)}function u(t){var e=t.polyfill?t.xtag.polyfillInput:t.xtag.dateInput,n=s(e.value);return n?t.removeAttribute("invalid"):t.setAttribute("invalid",!0),!!n}function l(t,e){var n=t.polyfill?t.xtag.polyfillInput.value:t.xtag.dateInput.value,r=s(n);t.value=e&&r?r:n}function c(t,e,n){var r=t.submitValue,i=t.value;e();var o=t.submitValue,a=t.value;(r!==o||n&&i!==a)&&xtag.fireEvent(t,"change")}var d=13,f=/(\d{4})[^\d]?(\d{2})[^\d]?(\d{2})/;xtag.register("x-datepicker",{lifecycle:{created:function(){this.innerHTML="",this.xtag.dateInput=document.createElement("input"),this.xtag.dateInput.setAttribute("type","date"),xtag.addClass(this.xtag.dateInput,"x-datepicker-input"),this.appendChild(this.xtag.dateInput),this.xtag.polyfillInput=null,this.xtag.polyfillUI=null,this.polyfill=this.hasAttribute("polyfill")||"date"!==this.xtag.dateInput.type.toLowerCase()}},events:{"datetoggleon:delegate(x-calendar)":function(t){var e=t.currentTarget;if(t.detail&&t.detail.date){var n=s(t.detail.date);c(e,function(){e.value=n?o(n):"",xtag.fireEvent(e,"input")})}},"datetoggleoff:delegate(x-calendar)":function(t){var e=t.currentTarget;e.value=null},focus:function(t){var e=t.currentTarget;e.setAttribute("focused",!0)},"blur:delegate(.x-datepicker-input)":function(t){t.currentTarget.removeAttribute("focused")},"blur:delegate(.x-datepicker-polyfill-input)":function(t){var e=t.currentTarget;e.removeAttribute("focused"),c(e,function(){l(e,!0)},!0)},"touchstart:delegate(.x-datepicker-polyfill-input)":function(){this.setAttribute("readonly",!0)},"tapstart:delegate(x-calendar)":function(t){t.preventDefault()},"keypress:delegate(.x-datepicker-polyfill-input)":function(t){var e=t.keyCode;e===d&&c(t.currentTarget,function(){l(t.currentTarget,!0)},!0)},"input:delegate(.x-datepicker-input)":function(t){c(t.currentTarget,function(){l(t.currentTarget,!0),t.stopPropagation(),xtag.fireEvent(t.currentTarget,"input")})},"input:delegate(.x-datepicker-polyfill-input)":function(t){c(t.currentTarget,function(){l(t.currentTarget,!1),t.stopPropagation(),xtag.fireEvent(t.currentTarget,"input")})},"change:delegate(.x-datepicker-input)":function(t){t.stopPropagation(),xtag.fireEvent(t.currentTarget,"change")},"change:delegate(.x-datepicker-polyfill-input)":function(t){t.stopPropagation(),c(t.currentTarget,function(){l(t.currentTarget,!1)})}},accessors:{name:{attribute:{selector:".x-datepicker-input"},set:function(t){null===t||void 0===t?this.xtag.dateInput.removeAttribute("name"):this.xtag.dateInput.setAttribute("name",t)}},submitValue:{get:function(){return this.xtag.dateInput.value}},value:{attribute:{skip:!0},get:function(){return this.polyfill?this.xtag.polyfillInput.value:this.xtag.dateInput.value},set:function(t){var e=s(t),n=e?o(e):null,r=this.xtag.dateInput,i=this.xtag.polyfillInput,a=this.xtag.polyfillUI;if(null===t||void 0===t)this.removeAttribute("value"),r.value="",i&&(i.value=""),a&&(a.chosen=null);else{var l=n?n:t;i?t!==i.value?(i.value=l,this.setAttribute("value",l)):this.setAttribute("value",t):this.setAttribute("value",l),n?(r.value=n,a&&(a.chosen=e,a.view=e)):(r.value="",a&&(a.chosen=null))}u(this)}},polyfill:{attribute:{"boolean":!0},set:function(t){var e=this.xtag.dateInput;if(t){if(e.setAttribute("type","hidden"),e.setAttribute("readonly",!0),!this.xtag.polyfillInput){var n=document.createElement("input");xtag.addClass(n,"x-datepicker-polyfill-input"),n.setAttribute("type","text"),n.setAttribute("placeholder","YYYY-MM-DD"),n.value=this.xtag.dateInput.value,this.xtag.polyfillInput=n,this.appendChild(n)}if(this.xtag.polyfillInput.removeAttribute("disabled"),!this.xtag.polyfillUI){var r=document.createElement("x-calendar");xtag.addClass(r,"x-datepicker-polyfill-ui"),r.chosen=this.value,r.view=this.xtag.dateInput.value,r.controls=!0,this.xtag.polyfillUI=r,this.appendChild(r)}}else e.setAttribute("type","date"),e.removeAttribute("readonly"),this.xtag.polyfillInput&&this.xtag.polyfillInput.setAttribute("disabled",!0)}}},methods:{editLabels:function(t){this.xtag.polyfillUI&&this.xtag.polyfillUI.labels&&(this.xtag.polyfillUI.labels=t)}}})}();